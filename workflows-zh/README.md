# GitHub 工作流文档

## 概述

本目录包含对 `.github/workflows/` 文件夹中所有工作流的中文详细说明。这些工作流充分利用了 Claude Code 的能力，实现了自动化代码审查、依赖管理、文档同步和质量控制。

## 工作流列表

### 1. [PR Claude Code Review](./pr-claude-code-review.md)

**文件名**：`pr-claude-code-review.yml`

**功能**：自动化拉取请求代码审查

**触发条件**：
- PR 创建、更新或重新打开时
- 在 PR 中提到 `@claude` 时

**特点**：
- 使用 Claude 进行深度代码审查
- 按严重程度组织反馈（Critical/Warning/Suggestion）
- 支持并发控制和任务取消
- 限制工具集确保安全性

---

### 2. [Scheduled - Dependency Audit](./scheduled-claude-code-dependency-audit.md)

**文件名**：`scheduled-claude-code-dependency-audit.yml`

**功能**：定时检查和更新项目依赖

**触发条件**：
- 定时：每月 1 日和 15 日 10:00 UTC
- 手动触发

**特点**：
- 检查过期依赖和安全漏洞
- Claude 智能分析更新风险
- 自动测试验证更新安全性
- 创建 PR 提交依赖更新

---

### 3. [Scheduled - Documentation Sync](./scheduled-claude-code-docs-sync.md)

**文件名**：`scheduled-claude-code-docs-sync.md`

**功能**：同步代码变更与相关文档

**触发条件**：
- 定时：每月 1 日 9:00 UTC
- 手动触发（支持自定义回溯天数）

**特点**：
- 检测代码变更并分析影响
- 只修复真正错误的文档
- 避免过度文档化
- 保持文档与代码的同步

---

### 4. [Scheduled - Code Quality Review](./scheduled-claude-code-quality.md)

**文件名**：`scheduled-claude-code-quality.yml`

**功能**：定时随机目录代码质量审查

**触发条件**：
- 定时：每周日 8:00 UTC
- 手动触发（支持自定义目录数量）

**特点**：
- 随机选择目录进行审查
- 并行处理提高效率
- 主动修复而非仅报告问题
- 全面覆盖代码质量维度

## 技术栈

### 共同特性
- **GitHub Actions**：容器化执行环境
- **Claude Code Action**：深度 AI 代码理解
- **Node.js 20**：运行时环境
- **并发控制**：高效的任务管理

### 安全措施
- 权限最小化原则
- 工具集限制
- 并发冲突避免
- 自动回滚机制

## 架构模式

### 工作流设计
1. **触发器**：事件驱动或定时触发
2. **前置检查**：判断是否需要执行
3. **Claude 处理**：核心智能分析
4. **后置验证**：质量检查
5. **结果输出**：PR 创建或报告

### Claude 集成模式
1. **环境准备**：检出代码、安装依赖
2. **上下文收集**：获取变更信息、配置文件
3. **智能分析**：应用审查标准和最佳实践
4. **行动执行**：修复问题、更新文档
5. **验证确认**：运行测试、检查质量

## 最佳实践

### 1. 频率规划
- **PR 审查**：实时触发
- **依赖审计**：半月一次
- **文档同步**：每月一次
- **质量审查**：每周一次

### 2. 资源优化
- 并发控制避免资源浪费
- 精确的触发条件
- 合理的超时设置
- 必要的缓存策略

### 3. 质量保证
- 多层验证机制
- 自动回滚保护
- 详细执行日志
- PR 审查集成

### 4. 用户体验
- 清晰的状态报告
- 友好的错误提示
- 可配置的参数
- 手动触发支持

## 监控和维护

### 监控指标
1. **执行成功率**
2. **平均执行时间**
3. **PR 创建数量**
4. **问题修复率**

### 维护建议
1. 定期检查 Claude 模型版本
2. 更新审查标准和最佳实践
3. 监控依赖安全公告
4. 优化工作流性能

### 故障排查
1. 查看 Actions 日志
2. 检查 secret 配置
3. 验证文件权限
4. 测试手动触发

## 扩展建议

### 可能的扩展
1. **多语言支持**：添加 Python、Go 等支持
2. **安全扫描**：集成更多安全检查工具
3. **性能监控**：添加性能基准测试
4. **覆盖率报告**：集成代码覆盖率工具

### 自定义化
1. 根据项目需求调整触发频率
2. 自定义审查标准和检查清单
3. 添加项目特定的验证步骤
4. 集成现有的 CI/CD 流程

## 总结

这套 GitHub 工作流展示了如何将 Claude Code 的强大能力集成到开发流程中，实现了：

1. **自动化质量保障**：减少人工审查负担
2. **持续改进**：定期更新依赖和文档
3. **智能修复**：主动解决代码问题
4. **最佳实践推广**：标准化开发规范

通过合理配置和维护，这些工作流可以显著提升开发效率和代码质量，是现代 AI 辅助开发的优秀实践案例。